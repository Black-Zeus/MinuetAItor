<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MinuetAItor - Equipo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* Estilos para el modal */
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }
        
        /* Animación para tabs */
        .tab-content {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Tab deshabilitado */
        .tab-disabled {
            opacity: 0.5;
            cursor: not-allowed !important;
            pointer-events: none;
        }
    </style>
</head>
<body class="bg-gray-50">

    <div class="max-w-[1400px] mx-auto p-6">

        <!-- ============================================ -->
        <!-- HEADER SECTION -->
        <!-- ============================================ -->
        <div class="mb-8">
            <div class="flex items-center justify-between mb-2">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900">Equipo</h1>
                    <p class="text-sm text-gray-500 mt-1">Gestión de usuarios y permisos del sistema</p>
                </div>
                <button onclick="openModal()" class="px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2">
                    <i class="fas fa-user-plus text-sm"></i>
                    Nuevo Usuario
                </button>
            </div>

            <!-- Stats Bar -->
            <div class="grid grid-cols-4 gap-4 mt-6">
                <div class="bg-white rounded-lg border border-gray-200 p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-xs text-gray-500 uppercase tracking-wide mb-1">Total Usuarios</p>
                            <p class="text-2xl font-bold text-gray-900">24</p>
                        </div>
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-users text-blue-600 text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg border border-gray-200 p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-xs text-gray-500 uppercase tracking-wide mb-1">Activos</p>
                            <p class="text-2xl font-bold text-green-600">21</p>
                        </div>
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-user-check text-green-600 text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg border border-gray-200 p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-xs text-gray-500 uppercase tracking-wide mb-1">Inactivos</p>
                            <p class="text-2xl font-bold text-gray-400">3</p>
                        </div>
                        <div class="w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-user-slash text-gray-400 text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg border border-gray-200 p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-xs text-gray-500 uppercase tracking-wide mb-1">Administradores</p>
                            <p class="text-2xl font-bold text-purple-600">4</p>
                        </div>
                        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-user-shield text-purple-600 text-xl"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- FILTER SECTION -->
        <!-- ============================================ -->
        <div class="bg-white rounded-lg border border-gray-200 p-5 mb-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-base font-semibold text-gray-900 flex items-center gap-2">
                    <i class="fas fa-filter text-gray-400 text-sm"></i>
                    Filtros
                </h2>
                <button class="text-sm text-blue-600 hover:text-blue-700 font-medium">
                    Limpiar filtros
                </button>
            </div>

            <div class="grid grid-cols-5 gap-4">
                <!-- Búsqueda -->
                <div class="col-span-2">
                    <label class="block text-xs font-medium text-gray-700 mb-1.5">Buscar</label>
                    <div class="relative">
                        <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm"></i>
                        <input 
                            type="text" 
                            placeholder="Nombre, email o cargo..."
                            class="w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                    </div>
                </div>

                <!-- Estado -->
                <div>
                    <label class="block text-xs font-medium text-gray-700 mb-1.5">Estado</label>
                    <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Todos</option>
                        <option value="active">Activo</option>
                        <option value="inactive">Inactivo</option>
                    </select>
                </div>

                <!-- Rol del Sistema -->
                <div>
                    <label class="block text-xs font-medium text-gray-700 mb-1.5">Rol del Sistema</label>
                    <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Todos</option>
                        <option value="admin">Administrador</option>
                        <option value="write">Escritura</option>
                        <option value="read">Lectura</option>
                    </select>
                </div>

                <!-- Cliente Asignado -->
                <div>
                    <label class="block text-xs font-medium text-gray-700 mb-1.5">Cliente</label>
                    <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Todos</option>
                        <option value="client1">TechCorp Solutions</option>
                        <option value="client2">Global Industries</option>
                        <option value="client3">StartupXYZ</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- DATA SECTION - Grid de Usuarios -->
        <!-- ============================================ -->
        <div>
            <div class="flex items-center justify-between mb-4">
                <p class="text-sm text-gray-600">
                    Mostrando <span class="font-semibold text-gray-900">24</span> usuarios
                </p>
                <div class="flex items-center gap-3">
                    <select class="px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option>Ordenar: Nombre A-Z</option>
                        <option>Ordenar: Nombre Z-A</option>
                        <option>Ordenar: Fecha de alta</option>
                        <option>Ordenar: Última actividad</option>
                    </select>
                </div>
            </div>

            <!-- Grid de Cards (simplificado) -->
            <div class="grid grid-cols-3 gap-5">
                <div class="bg-white rounded-lg border border-gray-200 hover:border-blue-300 hover:shadow-md transition-all duration-200 overflow-hidden group">
                    <div class="p-5 pb-4 border-b border-gray-100">
                        <div class="flex items-start justify-between mb-3">
                            <div class="flex items-center gap-3">
                                <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-lg flex-shrink-0">
                                    MA
                                </div>
                                <div>
                                    <h3 class="text-base font-semibold text-gray-900 leading-tight group-hover:text-blue-600 transition-colors">
                                        María Rodríguez
                                    </h3>
                                    <p class="text-xs text-gray-500 mt-0.5">Project Manager</p>
                                </div>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full">
                                Activo
                            </span>
                        </div>
                        <div class="flex items-center gap-2 text-xs text-gray-600">
                            <i class="fas fa-envelope text-gray-400"></i>
                            <span>maria.rodriguez@company.com</span>
                        </div>
                    </div>

                    <div class="p-5 pt-4 pb-4 bg-gray-50">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-xs font-semibold text-gray-700 uppercase tracking-wide">Rol del Sistema</span>
                            <span class="px-2.5 py-1 bg-purple-100 text-purple-700 text-xs font-semibold rounded-md flex items-center gap-1.5">
                                <i class="fas fa-user-shield"></i>
                                Administrador
                            </span>
                        </div>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between text-xs">
                                <span class="text-gray-600">Acceso total al sistema</span>
                                <i class="fas fa-check-circle text-purple-600"></i>
                            </div>
                        </div>
                    </div>

                    <div class="p-5 pt-4 pb-4 border-t border-gray-200">
                        <div class="mb-3">
                            <span class="text-xs font-semibold text-gray-700 uppercase tracking-wide">Asignaciones</span>
                        </div>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between text-xs">
                                <span class="text-gray-600">Clientes asignados</span>
                                <span class="font-semibold text-gray-900">Todos (8)</span>
                            </div>
                            <div class="flex items-center justify-between text-xs">
                                <span class="text-gray-600">Proyectos asignados</span>
                                <span class="font-semibold text-gray-900">Todos (24)</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-5 pt-3 pb-4 bg-gray-50 border-t border-gray-200">
                        <div class="flex items-center justify-between mb-3 text-xs text-gray-500">
                            <span class="flex items-center gap-1.5">
                                <i class="fas fa-calendar-plus text-gray-400"></i>
                                Alta: 15 Ene 2024
                            </span>
                        </div>
                        <div class="flex items-center gap-2">
                            <button class="flex-1 px-3 py-2 bg-white hover:bg-gray-50 border border-gray-300 text-gray-700 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2">
                                <i class="fas fa-eye text-xs"></i>
                                Ver Detalles
                            </button>
                            <button class="px-3 py-2 bg-white hover:bg-gray-50 border border-gray-300 text-gray-700 rounded-lg transition-colors">
                                <i class="fas fa-ellipsis-vertical text-sm"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- ============================================ -->
    <!-- MODAL NUEVO USUARIO CON TABS -->
    <!-- ============================================ -->
    <div id="userModal" class="fixed inset-0 z-50 hidden items-center justify-center modal-overlay">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-5xl h-[85vh] flex flex-col">
            
            <!-- Modal Header -->
            <div class="flex items-center justify-between px-6 py-4 border-b border-gray-200 flex-shrink-0">
                <div>
                    <h2 class="text-xl font-bold text-gray-900">Nuevo Usuario</h2>
                    <p class="text-sm text-gray-500 mt-0.5">Configura la información y permisos del usuario</p>
                </div>
                <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <!-- Tabs Navigation -->
            <div class="px-6 pt-4 border-b border-gray-200 flex-shrink-0">
                <div class="flex gap-1 overflow-x-auto">
                    <button onclick="switchTab(1)" id="tab-btn-1" class="tab-button active px-4 py-2.5 text-sm font-medium rounded-t-lg transition-colors border-b-2 border-blue-600 text-blue-600 bg-blue-50 whitespace-nowrap">
                        <i class="fas fa-user mr-2"></i>
                        Información General
                    </button>
                    <button onclick="switchTab(2)" id="tab-btn-2" class="tab-button px-4 py-2.5 text-sm font-medium rounded-t-lg transition-colors border-b-2 border-transparent text-gray-600 hover:text-gray-900 hover:bg-gray-50 whitespace-nowrap">
                        <i class="fas fa-shield-halved mr-2"></i>
                        Rol del Sistema
                    </button>
                    <button onclick="switchTab(3)" id="tab-btn-3" class="tab-button px-4 py-2.5 text-sm font-medium rounded-t-lg transition-colors border-b-2 border-transparent text-gray-600 hover:text-gray-900 hover:bg-gray-50 whitespace-nowrap">
                        <i class="fas fa-briefcase mr-2"></i>
                        Asignación de Acceso
                    </button>
                    <button onclick="switchTab(4)" id="tab-btn-4" class="tab-button tab-disabled px-4 py-2.5 text-sm font-medium rounded-t-lg transition-colors border-b-2 border-transparent text-gray-600 whitespace-nowrap">
                        <i class="fas fa-users mr-2"></i>
                        Clientes y Proyectos
                    </button>
                    <button onclick="switchTab(5)" id="tab-btn-5" class="tab-button px-4 py-2.5 text-sm font-medium rounded-t-lg transition-colors border-b-2 border-transparent text-gray-600 hover:text-gray-900 hover:bg-gray-50 whitespace-nowrap">
                        <i class="fas fa-lock mr-2"></i>
                        Proyectos Confidenciales
                    </button>
                </div>
            </div>

            <!-- Modal Content - Scrollable con altura fija -->
            <div class="flex-1 overflow-y-auto px-6 py-6">

                <!-- ========== TAB 1: INFORMACIÓN GENERAL ========== -->
                <div id="tab-content-1" class="tab-content">
                    <div class="space-y-6">
                        
                        <!-- Avatar Preview -->
                        <div class="flex items-center gap-6 pb-6 border-b border-gray-200">
                            <div class="w-24 h-24 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold text-3xl flex-shrink-0">
                                <i class="fas fa-user"></i>
                            </div>
                            <div>
                                <h3 class="text-base font-semibold text-gray-900 mb-1">Foto de perfil</h3>
                                <p class="text-sm text-gray-500 mb-3">Las iniciales se generarán automáticamente</p>
                                <button class="px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors">
                                    <i class="fas fa-upload mr-2"></i>
                                    Subir foto
                                </button>
                            </div>
                        </div>

                        <!-- Información personal -->
                        <div class="grid grid-cols-2 gap-5">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Nombre completo <span class="text-red-500">*</span>
                                </label>
                                <input 
                                    type="text" 
                                    placeholder="Ej: Juan Pérez"
                                    class="w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                >
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Email corporativo <span class="text-red-500">*</span>
                                </label>
                                <input 
                                    type="email" 
                                    placeholder="juan.perez@company.com"
                                    class="w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                >
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Cargo / Puesto <span class="text-red-500">*</span>
                                </label>
                                <input 
                                    type="text" 
                                    placeholder="Ej: Project Manager"
                                    class="w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                >
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Teléfono
                                </label>
                                <input 
                                    type="tel" 
                                    placeholder="+56 9 1234 5678"
                                    class="w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                >
                            </div>
                        </div>

                        <!-- Departamento y estado -->
                        <div class="grid grid-cols-2 gap-5">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Departamento
                                </label>
                                <select class="w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="">Seleccionar departamento</option>
                                    <option value="it">Tecnología</option>
                                    <option value="sales">Ventas</option>
                                    <option value="marketing">Marketing</option>
                                    <option value="operations">Operaciones</option>
                                    <option value="hr">Recursos Humanos</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Estado inicial
                                </label>
                                <select class="w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="active">Activo</option>
                                    <option value="inactive">Inactivo</option>
                                </select>
                            </div>
                        </div>

                        <!-- Notas -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Notas internas
                            </label>
                            <textarea 
                                rows="3"
                                placeholder="Información adicional sobre el usuario..."
                                class="w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                            ></textarea>
                        </div>

                    </div>
                </div>

                <!-- ========== TAB 2: ROL DEL SISTEMA ========== -->
                <div id="tab-content-2" class="tab-content hidden">
                    <div class="space-y-6">
                        
                        <!-- Descripción -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <div class="flex gap-3">
                                <i class="fas fa-info-circle text-blue-600 text-lg mt-0.5"></i>
                                <div>
                                    <h4 class="text-sm font-semibold text-blue-900 mb-1">Sobre los roles del sistema</h4>
                                    <p class="text-sm text-blue-700">
                                        El rol del sistema define los permisos globales del usuario en MinuetAItor. Esto es independiente de los permisos específicos por cliente/proyecto.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Selector de Rol -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-900 mb-4">
                                Selecciona el rol del sistema <span class="text-red-500">*</span>
                            </label>

                            <!-- Opción: Administrador -->
                            <div class="mb-4">
                                <label class="flex items-start gap-4 p-5 border-2 border-gray-300 rounded-lg cursor-pointer hover:border-purple-300 hover:bg-purple-50 transition-all">
                                    <input type="radio" name="systemRole" value="admin" class="mt-1 w-4 h-4 text-purple-600 focus:ring-purple-500">
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2 mb-2">
                                            <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                                                <i class="fas fa-user-shield text-purple-600"></i>
                                            </div>
                                            <div>
                                                <h4 class="text-base font-semibold text-gray-900">Administrador</h4>
                                                <p class="text-xs text-purple-600 font-medium">Acceso total al sistema</p>
                                            </div>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-3">
                                            Control completo sobre todos los módulos, usuarios y configuraciones del sistema.
                                        </p>
                                        <div class="grid grid-cols-2 gap-2">
                                            <div class="flex items-center gap-2 text-xs text-gray-700">
                                                <i class="fas fa-check text-purple-600"></i>
                                                <span>Gestión de usuarios</span>
                                            </div>
                                            <div class="flex items-center gap-2 text-xs text-gray-700">
                                                <i class="fas fa-check text-purple-600"></i>
                                                <span>Configuración del sistema</span>
                                            </div>
                                            <div class="flex items-center gap-2 text-xs text-gray-700">
                                                <i class="fas fa-check text-purple-600"></i>
                                                <span>Acceso a todos los clientes</span>
                                            </div>
                                            <div class="flex items-center gap-2 text-xs text-gray-700">
                                                <i class="fas fa-check text-purple-600"></i>
                                                <span>Eliminar cualquier contenido</span>
                                            </div>
                                        </div>
                                    </div>
                                </label>
                            </div>

                            <!-- Opción: Escritura -->
                            <div class="mb-4">
                                <label class="flex items-start gap-4 p-5 border-2 border-gray-300 rounded-lg cursor-pointer hover:border-blue-300 hover:bg-blue-50 transition-all">
                                    <input type="radio" name="systemRole" value="write" class="mt-1 w-4 h-4 text-blue-600 focus:ring-blue-500">
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2 mb-2">
                                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                                <i class="fas fa-pen text-blue-600"></i>
                                            </div>
                                            <div>
                                                <h4 class="text-base font-semibold text-gray-900">Escritura</h4>
                                                <p class="text-xs text-blue-600 font-medium">Crear y editar contenido</p>
                                            </div>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-3">
                                            Puede crear y editar contenido en los clientes/proyectos asignados. No puede eliminar ni gestionar usuarios.
                                        </p>
                                        <div class="grid grid-cols-2 gap-2">
                                            <div class="flex items-center gap-2 text-xs text-gray-700">
                                                <i class="fas fa-check text-blue-600"></i>
                                                <span>Crear reuniones</span>
                                            </div>
                                            <div class="flex items-center gap-2 text-xs text-gray-700">
                                                <i class="fas fa-check text-blue-600"></i>
                                                <span>Editar contenido propio</span>
                                            </div>
                                            <div class="flex items-center gap-2 text-xs text-gray-700">
                                                <i class="fas fa-check text-blue-600"></i>
                                                <span>Subir archivos</span>
                                            </div>
                                            <div class="flex items-center gap-2 text-xs text-gray-700">
                                                <i class="fas fa-times text-gray-400"></i>
                                                <span>Eliminar contenido</span>
                                            </div>
                                        </div>
                                    </div>
                                </label>
                            </div>

                            <!-- Opción: Lectura -->
                            <div class="mb-4">
                                <label class="flex items-start gap-4 p-5 border-2 border-gray-300 rounded-lg cursor-pointer hover:border-green-300 hover:bg-green-50 transition-all">
                                    <input type="radio" name="systemRole" value="read" class="mt-1 w-4 h-4 text-green-600 focus:ring-green-500">
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2 mb-2">
                                            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                                                <i class="fas fa-eye text-green-600"></i>
                                            </div>
                                            <div>
                                                <h4 class="text-base font-semibold text-gray-900">Lectura</h4>
                                                <p class="text-xs text-green-600 font-medium">Solo visualización</p>
                                            </div>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-3">
                                            Solo puede ver y descargar contenido. No puede crear, editar ni eliminar nada en el sistema.
                                        </p>
                                        <div class="grid grid-cols-2 gap-2">
                                            <div class="flex items-center gap-2 text-xs text-gray-700">
                                                <i class="fas fa-check text-green-600"></i>
                                                <span>Ver reuniones</span>
                                            </div>
                                            <div class="flex items-center gap-2 text-xs text-gray-700">
                                                <i class="fas fa-check text-green-600"></i>
                                                <span>Descargar archivos</span>
                                            </div>
                                            <div class="flex items-center gap-2 text-xs text-gray-700">
                                                <i class="fas fa-times text-gray-400"></i>
                                                <span>Crear contenido</span>
                                            </div>
                                            <div class="flex items-center gap-2 text-xs text-gray-700">
                                                <i class="fas fa-times text-gray-400"></i>
                                                <span>Editar contenido</span>
                                            </div>
                                        </div>
                                    </div>
                                </label>
                            </div>

                        </div>

                    </div>
                </div>

                <!-- ========== TAB 3: ASIGNACIÓN DE ACCESO ========== -->
                <div id="tab-content-3" class="tab-content hidden">
                    <div class="space-y-6">
                        
                        <!-- Descripción -->
                        <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                            <div class="flex gap-3">
                                <i class="fas fa-info-circle text-amber-600 text-lg mt-0.5"></i>
                                <div>
                                    <h4 class="text-sm font-semibold text-amber-900 mb-1">Asignación de acceso</h4>
                                    <p class="text-sm text-amber-700">
                                        Define a qué clientes y proyectos regulares tendrá acceso este usuario. Los proyectos confidenciales se asignan en un tab separado.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Modo de asignación -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-900 mb-3">
                                Modo de asignación <span class="text-red-500">*</span>
                            </label>

                            <div class="space-y-3">
                                <!-- Opción: Todos los clientes -->
                                <label class="flex items-center gap-4 p-4 border-2 border-gray-300 rounded-lg cursor-pointer hover:border-blue-300 hover:bg-blue-50 transition-all">
                                    <input 
                                        type="radio" 
                                        name="assignmentMode" 
                                        value="all" 
                                        class="w-4 h-4 text-blue-600 focus:ring-blue-500"
                                        onchange="handleAssignmentModeChange('all')"
                                    >
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2 mb-1">
                                            <i class="fas fa-globe text-blue-600"></i>
                                            <h4 class="text-sm font-semibold text-gray-900">Todos los clientes y proyectos</h4>
                                        </div>
                                        <p class="text-xs text-gray-600">El usuario tendrá acceso a todos los clientes y proyectos existentes y futuros (excepto confidenciales)</p>
                                    </div>
                                </label>

                                <!-- Opción: Clientes específicos -->
                                <label class="flex items-center gap-4 p-4 border-2 border-blue-400 bg-blue-50 rounded-lg cursor-pointer transition-all">
                                    <input 
                                        type="radio" 
                                        name="assignmentMode" 
                                        value="specific" 
                                        class="w-4 h-4 text-blue-600 focus:ring-blue-500" 
                                        checked
                                        onchange="handleAssignmentModeChange('specific')"
                                    >
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2 mb-1">
                                            <i class="fas fa-filter text-blue-600"></i>
                                            <h4 class="text-sm font-semibold text-gray-900">Clientes y proyectos específicos</h4>
                                        </div>
                                        <p class="text-xs text-gray-600">Selecciona manualmente los clientes, proyectos y permisos específicos en el siguiente tab</p>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- Mensaje informativo -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <div class="flex items-start gap-3">
                                <i class="fas fa-arrow-right text-blue-600 text-lg mt-0.5"></i>
                                <div>
                                    <h5 class="text-sm font-semibold text-blue-900 mb-1">Siguiente paso</h5>
                                    <p class="text-sm text-blue-700">
                                        Si seleccionaste "Clientes y proyectos específicos", continúa al siguiente tab para configurar los accesos detallados.
                                    </p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- ========== TAB 4: CLIENTES Y PROYECTOS ========== -->
                <div id="tab-content-4" class="tab-content hidden">
                    <div class="space-y-6">
                        
                        <!-- Header -->
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <h4 class="text-sm font-semibold text-gray-900">Clientes y Proyectos</h4>
                                <p class="text-xs text-gray-500 mt-0.5">Selecciona los clientes y define permisos por proyecto</p>
                            </div>
                            <div class="text-xs text-gray-600">
                                <span class="font-semibold text-blue-600">2</span> clientes seleccionados
                            </div>
                        </div>

                        <!-- Buscador de clientes -->
                        <div>
                            <div class="relative">
                                <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                                <input 
                                    type="text" 
                                    placeholder="Buscar cliente..."
                                    class="w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                                >
                            </div>
                        </div>

                        <!-- Lista de clientes en accordion -->
                        <div class="space-y-3 max-h-[380px] overflow-y-auto pr-2">
                            
                            <!-- ========== CLIENTE 1 - EXPANDIDO ========== -->
                            <div class="border border-gray-300 rounded-lg overflow-hidden bg-white">
                                
                                <!-- Header del cliente CON TOGGLE DE VISIBILIDAD -->
<div class="p-4 bg-gray-50 border-b border-gray-200">
    <div class="flex items-center justify-between">
        <div class="flex items-center gap-3 flex-1">
            <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white font-semibold text-sm flex-shrink-0">
                TC
            </div>
            <div class="flex-1">
                <h5 class="text-sm font-semibold text-gray-900">TechCorp Solutions</h5>
                <p class="text-xs text-gray-500">tech@company.com</p>
            </div>
            <div class="flex items-center gap-3">
                <span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded">
                    5 proyectos
                </span>
            </div>
            <button 
                onclick="toggleAccordion('client-1-projects')"
                class="p-2 hover:bg-gray-100 rounded-lg transition-colors"
            >
                <i class="fas fa-chevron-down text-gray-400" id="icon-client-1-projects"></i>
            </button>
        </div>
    </div>
    
    <!-- TOGGLE DE VISIBILIDAD DEL CLIENTE (SIN PERMISOS GENERALES) -->
    <div class="mt-3 pt-3 border-t border-gray-200 flex items-center justify-between">
        <div class="flex items-center gap-2">
            <i class="fas fa-eye text-gray-600 text-sm"></i>
            <span class="text-xs font-medium text-gray-700">Cliente visible en la interfaz</span>
            <div class="relative inline-block ml-2">
                <button 
                    type="button" 
                    class="group relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer items-center justify-center rounded-full bg-blue-600"
                    onclick="this.querySelector('span.toggle-circle').classList.toggle('translate-x-4'); this.querySelector('span.toggle-circle').classList.toggle('translate-x-0'); this.classList.toggle('bg-blue-600'); this.classList.toggle('bg-gray-200');"
                >
                    <span class="sr-only">Cliente visible</span>
                    <span aria-hidden="true" class="pointer-events-none absolute h-full w-full rounded-md bg-white"></span>
                    <span aria-hidden="true" class="pointer-events-none absolute mx-auto h-4 w-8 rounded-full bg-gray-200 transition-colors duration-200 ease-in-out"></span>
                    <span aria-hidden="true" class="toggle-circle pointer-events-none absolute left-0 inline-block h-4 w-4 transform rounded-full border border-gray-200 bg-white shadow ring-0 transition-transform duration-200 ease-in-out translate-x-4"></span>
                </button>
            </div>
        </div>
        <span class="text-xs text-gray-500 italic">El usuario podrá ver este cliente al crear minutas</span>
    </div>
</div>

                                <!-- Body - Tabla de proyectos -->
                                <div id="client-1-projects" class="p-4">
                                    <div class="mb-3 flex items-center justify-between">
                                        <p class="text-xs font-medium text-gray-700">Proyectos de TechCorp Solutions</p>
                                        <button class="text-xs text-blue-600 hover:text-blue-700 font-medium">
                                            Seleccionar todos como Editor
                                        </button>
                                    </div>

                                    <!-- Tabla de proyectos -->
                                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                                        <table class="w-full text-sm">
                                            <thead class="bg-gray-50 border-b border-gray-200">
                                                <tr>
                                                    <th class="px-4 py-2.5 text-left text-xs font-semibold text-gray-700">Proyecto</th>
                                                    <th class="px-4 py-2.5 text-center text-xs font-semibold text-gray-700 w-24">
                                                        <div class="flex items-center justify-center gap-1">
                                                            <i class="fas fa-eye text-gray-400 text-xs"></i>
                                                            Lector
                                                        </div>
                                                    </th>
                                                    <th class="px-4 py-2.5 text-center text-xs font-semibold text-gray-700 w-24">
                                                        <div class="flex items-center justify-center gap-1">
                                                            <i class="fas fa-pen text-gray-400 text-xs"></i>
                                                            Editor
                                                        </div>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-gray-200">
                                                <!-- Proyecto 1 -->
                                                <tr class="hover:bg-gray-50 transition-colors">
                                                    <td class="px-4 py-3">
                                                        <div class="flex items-center gap-2">
                                                            <i class="fas fa-folder text-blue-600 text-sm"></i>
                                                            <div>
                                                                <p class="text-sm font-medium text-gray-900">Proyecto Alpha</p>
                                                                <p class="text-xs text-gray-500">Desarrollo de plataforma web</p>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p1-read"
                                                            class="w-4 h-4 text-green-600 rounded focus:ring-green-500"
                                                            onchange="handlePermissionChange('p1', 'read')"
                                                        >
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p1-edit"
                                                            class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500" 
                                                            checked
                                                            onchange="handlePermissionChange('p1', 'edit')"
                                                        >
                                                    </td>
                                                </tr>

                                                <!-- Proyecto 2 -->
                                                <tr class="hover:bg-gray-50 transition-colors">
                                                    <td class="px-4 py-3">
                                                        <div class="flex items-center gap-2">
                                                            <i class="fas fa-folder text-blue-600 text-sm"></i>
                                                            <div>
                                                                <p class="text-sm font-medium text-gray-900">Proyecto Beta</p>
                                                                <p class="text-xs text-gray-500">App móvil iOS/Android</p>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p2-read"
                                                            class="w-4 h-4 text-green-600 rounded focus:ring-green-500" 
                                                            checked
                                                            onchange="handlePermissionChange('p2', 'read')"
                                                        >
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p2-edit"
                                                            class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                                                            onchange="handlePermissionChange('p2', 'edit')"
                                                        >
                                                    </td>
                                                </tr>

                                                <!-- Proyecto 3 -->
                                                <tr class="hover:bg-gray-50 transition-colors">
                                                    <td class="px-4 py-3">
                                                        <div class="flex items-center gap-2">
                                                            <i class="fas fa-folder text-blue-600 text-sm"></i>
                                                            <div>
                                                                <p class="text-sm font-medium text-gray-900">Proyecto Gamma</p>
                                                                <p class="text-xs text-gray-500">Sistema de reportería</p>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p3-read"
                                                            class="w-4 h-4 text-green-600 rounded focus:ring-green-500"
                                                            onchange="handlePermissionChange('p3', 'read')"
                                                        >
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p3-edit"
                                                            class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                                                            onchange="handlePermissionChange('p3', 'edit')"
                                                        >
                                                    </td>
                                                </tr>

                                                <!-- Proyecto 4 -->
                                                <tr class="hover:bg-gray-50 transition-colors">
                                                    <td class="px-4 py-3">
                                                        <div class="flex items-center gap-2">
                                                            <i class="fas fa-folder text-blue-600 text-sm"></i>
                                                            <div>
                                                                <p class="text-sm font-medium text-gray-900">Migration Project</p>
                                                                <p class="text-xs text-gray-500">Migración a cloud</p>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p4-read"
                                                            class="w-4 h-4 text-green-600 rounded focus:ring-green-500"
                                                            onchange="handlePermissionChange('p4', 'read')"
                                                        >
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p4-edit"
                                                            class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                                                            onchange="handlePermissionChange('p4', 'edit')"
                                                        >
                                                    </td>
                                                </tr>

                                                <!-- Proyecto 5 -->
                                                <tr class="hover:bg-gray-50 transition-colors">
                                                    <td class="px-4 py-3">
                                                        <div class="flex items-center gap-2">
                                                            <i class="fas fa-folder text-blue-600 text-sm"></i>
                                                            <div>
                                                                <p class="text-sm font-medium text-gray-900">Support System</p>
                                                                <p class="text-xs text-gray-500">Sistema de tickets</p>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p5-read"
                                                            class="w-4 h-4 text-green-600 rounded focus:ring-green-500"
                                                            onchange="handlePermissionChange('p5', 'read')"
                                                        >
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p5-edit"
                                                            class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                                                            onchange="handlePermissionChange('p5', 'edit')"
                                                        >
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    <!-- Resumen de permisos del cliente -->
                                    <div class="mt-3 px-3 py-2 bg-blue-50 border border-blue-200 rounded-lg">
                                        <p class="text-xs text-blue-900">
                                            <i class="fas fa-info-circle text-blue-600 mr-2"></i>
                                            <span class="font-semibold">1 proyecto</span> con permisos de editor · 
                                            <span class="font-semibold">1 proyecto</span> con permisos de lector
                                        </p>
                                    </div>
                                </div>

                            </div>

                            <!-- ========== CLIENTE 2 - SELECCIONADO Y EXPANDIDO ========== -->
                            <div class="border border-blue-400 rounded-lg overflow-hidden bg-white">
                                
                                <div class="p-4 bg-blue-50 border-b border-blue-200">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-3 flex-1">
                                            <input 
                                                type="checkbox" 
                                                id="client-3"
                                                class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500" 
                                                checked
                                            >
                                            <label for="client-3" class="flex items-center gap-3 flex-1 cursor-pointer">
                                                <div class="w-10 h-10 bg-purple-600 rounded-lg flex items-center justify-center text-white font-semibold text-sm flex-shrink-0">
                                                    SX
                                                </div>
                                                <div class="flex-1">
                                                    <h5 class="text-sm font-semibold text-gray-900">StartupXYZ</h5>
                                                    <p class="text-xs text-gray-500">hello@startupxyz.io</p>
                                                </div>
                                                <div class="flex items-center gap-3">
                                                    <span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded">
                                                        2 proyectos
                                                    </span>
                                                </div>
                                            </label>
                                            <button 
                                                onclick="toggleAccordion('client-3-projects')"
                                                class="p-2 hover:bg-blue-100 rounded-lg transition-colors"
                                            >
                                                <i class="fas fa-chevron-down text-gray-600" id="icon-client-3-projects"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div id="client-3-projects" class="p-4">
                                    <div class="mb-3 flex items-center justify-between">
                                        <p class="text-xs font-medium text-gray-700">Proyectos de StartupXYZ</p>
                                        <button class="text-xs text-blue-600 hover:text-blue-700 font-medium">
                                            Seleccionar todos como Editor
                                        </button>
                                    </div>

                                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                                        <table class="w-full text-sm">
                                            <thead class="bg-gray-50 border-b border-gray-200">
                                                <tr>
                                                    <th class="px-4 py-2.5 text-left text-xs font-semibold text-gray-700">Proyecto</th>
                                                    <th class="px-4 py-2.5 text-center text-xs font-semibold text-gray-700 w-24">
                                                        <div class="flex items-center justify-center gap-1">
                                                            <i class="fas fa-eye text-gray-400 text-xs"></i>
                                                            Lector
                                                        </div>
                                                    </th>
                                                    <th class="px-4 py-2.5 text-center text-xs font-semibold text-gray-700 w-24">
                                                        <div class="flex items-center justify-center gap-1">
                                                            <i class="fas fa-pen text-gray-400 text-xs"></i>
                                                            Editor
                                                        </div>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-gray-200">
                                                <tr class="hover:bg-gray-50 transition-colors">
                                                    <td class="px-4 py-3">
                                                        <div class="flex items-center gap-2">
                                                            <i class="fas fa-folder text-blue-600 text-sm"></i>
                                                            <div>
                                                                <p class="text-sm font-medium text-gray-900">MVP Development</p>
                                                                <p class="text-xs text-gray-500">Producto mínimo viable</p>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p6-read"
                                                            class="w-4 h-4 text-green-600 rounded focus:ring-green-500"
                                                            onchange="handlePermissionChange('p6', 'read')"
                                                        >
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p6-edit"
                                                            class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500" 
                                                            checked
                                                            onchange="handlePermissionChange('p6', 'edit')"
                                                        >
                                                    </td>
                                                </tr>

                                                <tr class="hover:bg-gray-50 transition-colors">
                                                    <td class="px-4 py-3">
                                                        <div class="flex items-center gap-2">
                                                            <i class="fas fa-folder text-blue-600 text-sm"></i>
                                                            <div>
                                                                <p class="text-sm font-medium text-gray-900">Market Launch</p>
                                                                <p class="text-xs text-gray-500">Estrategia de lanzamiento</p>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p7-read"
                                                            class="w-4 h-4 text-green-600 rounded focus:ring-green-500"
                                                            onchange="handlePermissionChange('p7', 'read')"
                                                        >
                                                    </td>
                                                    <td class="px-4 py-3 text-center">
                                                        <input 
                                                            type="checkbox" 
                                                            id="p7-edit"
                                                            class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                                                            onchange="handlePermissionChange('p7', 'edit')"
                                                        >
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    <div class="mt-3 px-3 py-2 bg-blue-50 border border-blue-200 rounded-lg">
                                        <p class="text-xs text-blue-900">
                                            <i class="fas fa-info-circle text-blue-600 mr-2"></i>
                                            <span class="font-semibold">1 proyecto</span> con permisos de editor
                                        </p>
                                    </div>
                                </div>

                            </div>

                        </div>

                    </div>
                </div>

                <!-- ========== TAB 5: PROYECTOS CONFIDENCIALES ========== -->
<div id="tab-content-5" class="tab-content hidden">
    <div class="space-y-6">
        
        <!-- Descripción -->
        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
            <div class="flex gap-3">
                <i class="fas fa-exclamation-triangle text-red-600 text-lg mt-0.5"></i>
                <div>
                    <h4 class="text-sm font-semibold text-red-900 mb-1">Acceso sensible - Proyectos Confidenciales</h4>
                    <p class="text-sm text-red-700">
                        Estos proyectos contienen información sensible y requieren asignación explícita.<br />
                        NO se incluyen en "Todos los clientes". Solo asigna acceso a usuarios autorizados.
                    </p>
                </div>
            </div>
        </div>

        <!-- Información adicional -->
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
            <div class="flex items-start gap-3">
                <i class="fas fa-info-circle text-gray-600 text-lg mt-0.5"></i>
                <div class="flex-1">
                    <h5 class="text-sm font-semibold text-gray-900 mb-2">¿Qué son los proyectos confidenciales?</h5>
                    <ul class="text-sm text-gray-700 space-y-1.5">
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-gray-500 text-xs mt-1"></i>
                            <span>Proyectos con información sensible, estratégica, financiera o legal sensible</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-gray-500 text-xs mt-1"></i>
                            <span>Requieren asignación manual y explícita de cada usuario</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-gray-500 text-xs mt-1"></i>
                            <span>Cada <strong>asignacion</strong> queda registrado en el sistema de auditoría</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Header con contador -->
        <div class="flex items-center justify-between">
            <div>
                <h4 class="text-sm font-semibold text-gray-900">Proyectos Confidenciales por Cliente</h4>
                <p class="text-xs text-gray-500 mt-0.5">Selecciona proyectos sensibles y define permisos</p>
            </div>
            <div class="text-xs text-gray-600">
                <span class="font-semibold text-red-600">1</span> proyecto asignado
            </div>
        </div>

        <!-- Lista de clientes con proyectos confidenciales (SIN max-height para evitar doble scroll) -->
        <div class="space-y-3">
            
            <!-- Cliente 1 -->
            <div class="border border-gray-300 rounded-lg overflow-hidden bg-white">
                <div class="p-4 bg-gray-50 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3 flex-1">
                            <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white font-semibold text-sm flex-shrink-0">
                                TC
                            </div>
                            <div class="flex-1">
                                <h5 class="text-sm font-semibold text-gray-900">TechCorp Solutions</h5>
                                <p class="text-xs text-gray-500">1 proyecto confidencial</p>
                            </div>
                            <button 
                                onclick="toggleAccordion('conf-client-1-projects')"
                                class="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                            >
                                <i class="fas fa-chevron-down text-gray-400" id="icon-conf-client-1-projects"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div id="conf-client-1-projects" class="p-4">
                    <div class="space-y-3">
                        <div class="border border-gray-300 rounded-lg p-4 bg-white">
                            <div class="flex items-start gap-3">
                                <input type="checkbox" id="conf-p1" class="mt-1 w-4 h-4 text-red-600 rounded focus:ring-red-500">
                                <div class="flex-1">
                                    <div class="flex items-start justify-between mb-2">
                                        <div class="flex-1">
                                            <div class="flex items-center gap-2 mb-1">
                                                <i class="fas fa-lock text-gray-400 text-sm"></i>
                                                <h5 class="text-sm font-semibold text-gray-900">Fusión Empresarial Q1 2026</h5>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-1">Información estratégica sobre proceso de M&A</p>
                                        </div>
                                        <span class="px-2 py-1 bg-gray-100 text-gray-600 text-xs font-semibold rounded flex-shrink-0">
                                            CONFIDENCIAL
                                        </span>
                                    </div>
                                    <div class="flex items-center gap-4 mt-3 pt-3 border-t border-gray-200">
                                        <span class="text-xs text-gray-500 italic">Marca el checkbox para asignar permisos</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cliente 2 -->
            <div class="border border-red-300 rounded-lg overflow-hidden bg-white">
                <div class="p-4 bg-red-50 border-b border-red-200">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3 flex-1">
                            <div class="w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center text-white font-semibold text-sm flex-shrink-0">
                                GI
                            </div>
                            <div class="flex-1">
                                <h5 class="text-sm font-semibold text-gray-900">Global Industries</h5>
                                <p class="text-xs text-gray-500">1 proyecto confidencial</p>
                            </div>
                            <button 
                                onclick="toggleAccordion('conf-client-2-projects')"
                                class="p-2 hover:bg-red-100 rounded-lg transition-colors"
                            >
                                <i class="fas fa-chevron-down text-gray-600" id="icon-conf-client-2-projects"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div id="conf-client-2-projects" class="p-4">
                    <div class="space-y-3">
                        <div class="border border-red-300 rounded-lg p-4 bg-red-50">
                            <div class="flex items-start gap-3">
                                <input type="checkbox" id="conf-p2" class="mt-1 w-4 h-4 text-red-600 rounded focus:ring-red-500" checked>
                                <div class="flex-1">
                                    <div class="flex items-start justify-between mb-2">
                                        <div class="flex-1">
                                            <div class="flex items-center gap-2 mb-1">
                                                <i class="fas fa-lock text-red-600 text-sm"></i>
                                                <h5 class="text-sm font-semibold text-gray-900">Auditoría Financiera 2024</h5>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-1">Auditoría interna y documentación financiera sensible</p>
                                        </div>
                                        <span class="px-2 py-1 bg-red-100 text-red-700 text-xs font-semibold rounded flex-shrink-0">
                                            CONFIDENCIAL
                                        </span>
                                    </div>
                                    <div class="space-y-2 mt-3 pt-3 border-t border-red-200">
                                        <p class="text-xs font-medium text-gray-700 mb-2">Nivel de acceso:</p>
                                        <div class="flex items-center gap-4">
                                            <label class="flex items-center gap-2 text-xs text-gray-700 cursor-pointer px-3 py-2 border border-green-300 bg-green-50 rounded-lg">
                                                <input type="radio" name="conf-p2-perm" value="read" class="w-3.5 h-3.5 text-green-600" checked>
                                                <i class="fas fa-eye text-green-600"></i>
                                                <span class="font-medium">Lector</span>
                                            </label>
                                            <label class="flex items-center gap-2 text-xs text-gray-700 cursor-pointer px-3 py-2 border border-gray-300 bg-white rounded-lg hover:bg-blue-50 hover:border-blue-300">
                                                <input type="radio" name="conf-p2-perm" value="edit" class="w-3.5 h-3.5 text-blue-600">
                                                <i class="fas fa-pen text-blue-600"></i>
                                                <span class="font-medium">Editor</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cliente 3 -->
            <div class="border border-gray-300 rounded-lg overflow-hidden bg-white">
                <div class="p-4 bg-gray-50 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3 flex-1">
                            <div class="w-10 h-10 bg-purple-600 rounded-lg flex items-center justify-center text-white font-semibold text-sm flex-shrink-0">
                                SX
                            </div>
                            <div class="flex-1">
                                <h5 class="text-sm font-semibold text-gray-900">StartupXYZ</h5>
                                <p class="text-xs text-gray-500">1 proyecto confidencial</p>
                            </div>
                            <button 
                                onclick="toggleAccordion('conf-client-3-projects')"
                                class="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                            >
                                <i class="fas fa-chevron-down text-gray-400" id="icon-conf-client-3-projects"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div id="conf-client-3-projects" class="p-4">
                    <div class="space-y-3">
                        <div class="border border-gray-300 rounded-lg p-4 bg-white">
                            <div class="flex items-start gap-3">
                                <input type="checkbox" id="conf-p3" class="mt-1 w-4 h-4 text-red-600 rounded focus:ring-red-500">
                                <div class="flex-1">
                                    <div class="flex items-start justify-between mb-2">
                                        <div class="flex-1">
                                            <div class="flex items-center gap-2 mb-1">
                                                <i class="fas fa-lock text-gray-400 text-sm"></i>
                                                <h5 class="text-sm font-semibold text-gray-900">Reestructuración Organizacional</h5>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-1">Plan de reestructuración - RR.HH. confidencial</p>
                                        </div>
                                        <span class="px-2 py-1 bg-gray-100 text-gray-600 text-xs font-semibold rounded flex-shrink-0">
                                            CONFIDENCIAL
                                        </span>
                                    </div>
                                    <div class="flex items-center gap-4 mt-3 pt-3 border-t border-gray-200">
                                        <span class="text-xs text-gray-500 italic">Marca el checkbox para asignar permisos</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Notas finales -->
        <div class="space-y-3">
            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <div class="flex items-start gap-3">
                    <i class="fas fa-clipboard-check text-gray-600 text-lg mt-0.5"></i>
                    <div>
                        <h5 class="text-sm font-semibold text-gray-900 mb-1">Registro de auditoría</h5>
                        <p class="text-sm text-gray-700">
                            Todos los accesos a proyectos confidenciales quedan registrados con fecha, hora y usuario que otorgó el permiso.
                        </p>
                    </div>
                </div>
            </div>

            <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                <div class="flex items-start gap-3">
                    <i class="fas fa-user-check text-amber-600 text-lg mt-0.5"></i>
                    <div>
                        <h5 class="text-sm font-semibold text-amber-900 mb-1">Aprobación requerida</h5>
                        <p class="text-sm text-amber-700">
                            Aún cuando el administrador asigne permisos, el <span class="font-semibold">Owner del proyecto</span> debe ratificar o rechazar la solicitud de acceso antes de que el usuario pueda acceder al contenido confidencial.
                        </p>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

            </div>

            <!-- Modal Footer -->
            <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 flex items-center justify-between flex-shrink-0">
                <button onclick="closeModal()" class="px-4 py-2.5 text-gray-700 hover:text-gray-900 font-medium transition-colors">
                    Cancelar
                </button>
                <div class="flex items-center gap-3">
                    <button onclick="previousTab()" id="btn-previous" class="px-4 py-2.5 bg-white hover:bg-gray-50 border border-gray-300 text-gray-700 rounded-lg font-medium transition-colors hidden">
                        <i class="fas fa-arrow-left mr-2"></i>
                        Anterior
                    </button>
                    <button onclick="nextTab()" id="btn-next" class="px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors">
                        Siguiente
                        <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                    <button onclick="saveUser()" id="btn-save" class="px-4 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors hidden">
                        <i class="fas fa-check mr-2"></i>
                        Crear Usuario
                    </button>
                </div>
            </div>

        </div>
    </div>

    <script>
        let currentTab = 1;
const totalTabs = 5;
let assignmentMode = 'specific'; // Ya está en 'specific'

function openModal() {
    document.getElementById('userModal').classList.remove('hidden');
    document.getElementById('userModal').classList.add('flex');
    currentTab = 1;
    assignmentMode = 'specific'; // Asegurar que inicie en 'specific'
    
    // HABILITAR TAB 4 AL ABRIR EL MODAL (porque 'specific' es default)
    const tab4Btn = document.getElementById('tab-btn-4');
    tab4Btn.classList.remove('tab-disabled');
    
    updateTabVisibility();
}

        function closeModal() {
            document.getElementById('userModal').classList.add('hidden');
            document.getElementById('userModal').classList.remove('flex');
        }

        function switchTab(tabNumber) {
            // Prevenir acceso al Tab 4 si está deshabilitado
            if (tabNumber === 4 && assignmentMode === 'all') {
                return;
            }
            currentTab = tabNumber;
            updateTabVisibility();
        }

        function nextTab() {
            if (currentTab < totalTabs) {
                // Si estamos en Tab 3 y seleccionaron "Todos", saltar Tab 4
                if (currentTab === 3 && assignmentMode === 'all') {
                    currentTab = 5; // Saltar directamente a Tab 5 (Confidenciales)
                } else {
                    currentTab++;
                }
                updateTabVisibility();
            }
        }

        function previousTab() {
            if (currentTab > 1) {
                // Si estamos en Tab 5 y Tab 4 está deshabilitado, retroceder a Tab 3
                if (currentTab === 5 && assignmentMode === 'all') {
                    currentTab = 3;
                } else {
                    currentTab--;
                }
                updateTabVisibility();
            }
        }

        function handleAssignmentModeChange(mode) {
            assignmentMode = mode;
            const tab4Btn = document.getElementById('tab-btn-4');
            
            if (mode === 'all') {
                // Deshabilitar Tab 4
                tab4Btn.classList.add('tab-disabled');
            } else {
                // Habilitar Tab 4
                tab4Btn.classList.remove('tab-disabled');
            }
        }

        function updateTabVisibility() {
            // Ocultar todos los contenidos
            for (let i = 1; i <= totalTabs; i++) {
                document.getElementById(`tab-content-${i}`).classList.add('hidden');
                document.getElementById(`tab-btn-${i}`).classList.remove('active', 'border-blue-600', 'text-blue-600', 'bg-blue-50');
                
                // No agregar hover a tabs deshabilitados
                if (i === 4 && assignmentMode === 'all') {
                    document.getElementById(`tab-btn-${i}`).classList.remove('hover:text-gray-900', 'hover:bg-gray-50');
                } else {
                    document.getElementById(`tab-btn-${i}`).classList.add('border-transparent', 'text-gray-600');
                }
            }

            // Mostrar el tab actual
            document.getElementById(`tab-content-${currentTab}`).classList.remove('hidden');
            document.getElementById(`tab-btn-${currentTab}`).classList.add('active', 'border-blue-600', 'text-blue-600', 'bg-blue-50');
            document.getElementById(`tab-btn-${currentTab}`).classList.remove('border-transparent', 'text-gray-600');

            // Controlar botones de navegación
            const btnPrevious = document.getElementById('btn-previous');
            const btnNext = document.getElementById('btn-next');
            const btnSave = document.getElementById('btn-save');

            if (currentTab === 1) {
                btnPrevious.classList.add('hidden');
            } else {
                btnPrevious.classList.remove('hidden');
            }

            if (currentTab === totalTabs) {
                btnNext.classList.add('hidden');
                btnSave.classList.remove('hidden');
            } else {
                btnNext.classList.remove('hidden');
                btnSave.classList.add('hidden');
            }
        }

        function saveUser() {
            alert('Usuario creado exitosamente!');
            closeModal();
        }

        // Función para manejar permisos mutuamente excluyentes
        function handlePermissionChange(projectId, type) {
            const readCheckbox = document.getElementById(`${projectId}-read`);
            const editCheckbox = document.getElementById(`${projectId}-edit`);
            
            if (type === 'edit' && editCheckbox.checked) {
                readCheckbox.checked = false;
            } else if (type === 'read' && readCheckbox.checked) {
                editCheckbox.checked = false;
            }
        }

        // Toggle de accordion
        function toggleAccordion(id) {
            const content = document.getElementById(id);
            const icon = document.getElementById(`icon-${id}`);
            
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                icon.classList.remove('fa-chevron-right');
                icon.classList.add('fa-chevron-down');
            } else {
                content.classList.add('hidden');
                icon.classList.add('fa-chevron-right');
                icon.classList.remove('fa-chevron-down');
            }
        }

        // Cerrar modal al hacer clic fuera
        document.getElementById('userModal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>

</body>
</html>